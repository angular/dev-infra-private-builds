/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
(function (factory) {
    if (typeof module === "object" && typeof module.exports === "object") {
        var v = factory(require, exports);
        if (v !== undefined) module.exports = v;
    }
    else if (typeof define === "function" && define.amd) {
        define("@angular/dev-infra-private/pr/merge/config", ["require", "exports", "tslib", "@angular/dev-infra-private/utils/config"], factory);
    }
})(function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.loadAndValidateConfig = void 0;
    var tslib_1 = require("tslib");
    var config_1 = require("@angular/dev-infra-private/utils/config");
    /** Loads and validates the merge configuration. */
    function loadAndValidateConfig() {
        var config = config_1.getConfig();
        if (config.merge === undefined) {
            return { errors: ['No merge configuration found. Set the `merge` configuration.'] };
        }
        if (typeof config.merge !== 'function') {
            return { errors: ['Expected merge configuration to be defined lazily through a function.'] };
        }
        var mergeConfig = config.merge();
        var errors = validateMergeConfig(mergeConfig);
        if (errors.length) {
            return { errors: errors };
        }
        if (mergeConfig.remote) {
            mergeConfig.remote = tslib_1.__assign(tslib_1.__assign({}, config.github), mergeConfig.remote);
        }
        else {
            mergeConfig.remote = config.github;
        }
        // We always set the `remote` option, so we can safely cast the
        // config to `MergeConfigWithRemote`.
        return { config: mergeConfig };
    }
    exports.loadAndValidateConfig = loadAndValidateConfig;
    /** Validates the specified configuration. Returns a list of failure messages. */
    function validateMergeConfig(config) {
        var errors = [];
        if (!config.labels) {
            errors.push('No label configuration.');
        }
        else if (!Array.isArray(config.labels)) {
            errors.push('Label configuration needs to be an array.');
        }
        if (!config.claSignedLabel) {
            errors.push('No CLA signed label configured.');
        }
        if (!config.mergeReadyLabel) {
            errors.push('No merge ready label configured.');
        }
        if (config.githubApiMerge === undefined) {
            errors.push('No explicit choice of merge strategy. Please set `githubApiMerge`.');
        }
        return errors;
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlnLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vZGV2LWluZnJhL3ByL21lcmdlL2NvbmZpZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7O0dBTUc7Ozs7Ozs7Ozs7Ozs7O0lBRUgsa0VBQTJFO0lBb0UzRSxtREFBbUQ7SUFDbkQsU0FBZ0IscUJBQXFCO1FBQ25DLElBQU0sTUFBTSxHQUFpQyxrQkFBUyxFQUFFLENBQUM7UUFFekQsSUFBSSxNQUFNLENBQUMsS0FBSyxLQUFLLFNBQVMsRUFBRTtZQUM5QixPQUFPLEVBQUMsTUFBTSxFQUFFLENBQUMsOERBQThELENBQUMsRUFBQyxDQUFDO1NBQ25GO1FBRUQsSUFBSSxPQUFPLE1BQU0sQ0FBQyxLQUFLLEtBQUssVUFBVSxFQUFFO1lBQ3RDLE9BQU8sRUFBQyxNQUFNLEVBQUUsQ0FBQyx1RUFBdUUsQ0FBQyxFQUFDLENBQUM7U0FDNUY7UUFFRCxJQUFNLFdBQVcsR0FBRyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDbkMsSUFBTSxNQUFNLEdBQUcsbUJBQW1CLENBQUMsV0FBVyxDQUFDLENBQUM7UUFFaEQsSUFBSSxNQUFNLENBQUMsTUFBTSxFQUFFO1lBQ2pCLE9BQU8sRUFBQyxNQUFNLFFBQUEsRUFBQyxDQUFDO1NBQ2pCO1FBRUQsSUFBSSxXQUFXLENBQUMsTUFBTSxFQUFFO1lBQ3RCLFdBQVcsQ0FBQyxNQUFNLHlDQUFPLE1BQU0sQ0FBQyxNQUFNLEdBQUssV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1NBQ2hFO2FBQU07WUFDTCxXQUFXLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUM7U0FDcEM7UUFFRCwrREFBK0Q7UUFDL0QscUNBQXFDO1FBQ3JDLE9BQU8sRUFBQyxNQUFNLEVBQUUsV0FBb0MsRUFBQyxDQUFDO0lBQ3hELENBQUM7SUEzQkQsc0RBMkJDO0lBRUQsaUZBQWlGO0lBQ2pGLFNBQVMsbUJBQW1CLENBQUMsTUFBNEI7UUFDdkQsSUFBTSxNQUFNLEdBQWEsRUFBRSxDQUFDO1FBQzVCLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFO1lBQ2xCLE1BQU0sQ0FBQyxJQUFJLENBQUMseUJBQXlCLENBQUMsQ0FBQztTQUN4QzthQUFNLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUN4QyxNQUFNLENBQUMsSUFBSSxDQUFDLDJDQUEyQyxDQUFDLENBQUM7U0FDMUQ7UUFDRCxJQUFJLENBQUMsTUFBTSxDQUFDLGNBQWMsRUFBRTtZQUMxQixNQUFNLENBQUMsSUFBSSxDQUFDLGlDQUFpQyxDQUFDLENBQUM7U0FDaEQ7UUFDRCxJQUFJLENBQUMsTUFBTSxDQUFDLGVBQWUsRUFBRTtZQUMzQixNQUFNLENBQUMsSUFBSSxDQUFDLGtDQUFrQyxDQUFDLENBQUM7U0FDakQ7UUFDRCxJQUFJLE1BQU0sQ0FBQyxjQUFjLEtBQUssU0FBUyxFQUFFO1lBQ3ZDLE1BQU0sQ0FBQyxJQUFJLENBQUMsb0VBQW9FLENBQUMsQ0FBQztTQUNuRjtRQUNELE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgR29vZ2xlIExMQyBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGFuIE1JVC1zdHlsZSBsaWNlbnNlIHRoYXQgY2FuIGJlXG4gKiBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGF0IGh0dHBzOi8vYW5ndWxhci5pby9saWNlbnNlXG4gKi9cblxuaW1wb3J0IHtnZXRDb25maWcsIEdpdENsaWVudENvbmZpZywgTmdEZXZDb25maWd9IGZyb20gJy4uLy4uL3V0aWxzL2NvbmZpZyc7XG5cbmltcG9ydCB7R2l0aHViQXBpTWVyZ2VTdHJhdGVneUNvbmZpZ30gZnJvbSAnLi9zdHJhdGVnaWVzL2FwaS1tZXJnZSc7XG5cbi8qKlxuICogUG9zc2libGUgbWVyZ2UgbWV0aG9kcyBzdXBwb3J0ZWQgYnkgdGhlIEdpdGh1YiBBUEkuXG4gKiBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL3YzL3B1bGxzLyNtZXJnZS1hLXB1bGwtcmVxdWVzdC1tZXJnZS1idXR0b24uXG4gKi9cbmV4cG9ydCB0eXBlIEdpdGh1YkFwaU1lcmdlTWV0aG9kID0gJ21lcmdlJ3wnc3F1YXNoJ3wncmViYXNlJztcblxuLyoqXG4gKiBUYXJnZXQgbGFiZWxzIHJlcHJlc2VudCBHaXRodWIgcHVsbCByZXF1ZXN0cyBsYWJlbHMuIFRoZXNlIGxhYmVscyBpbnN0cnVjdCB0aGUgbWVyZ2VcbiAqIHNjcmlwdCBpbnRvIHdoaWNoIGJyYW5jaGVzIGEgZ2l2ZW4gcHVsbCByZXF1ZXN0IHNob3VsZCBiZSBtZXJnZWQgdG8uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVGFyZ2V0TGFiZWwge1xuICAvKiogUGF0dGVybiB0aGF0IG1hdGNoZXMgdGhlIGdpdmVuIHRhcmdldCBsYWJlbC4gKi9cbiAgcGF0dGVybjogUmVnRXhwfHN0cmluZztcbiAgLyoqXG4gICAqIExpc3Qgb2YgYnJhbmNoZXMgYSBwdWxsIHJlcXVlc3Qgd2l0aCB0aGlzIHRhcmdldCBsYWJlbCBzaG91bGQgYmUgbWVyZ2VkIGludG8uXG4gICAqIENhbiBhbHNvIGJlIHdyYXBwZWQgaW4gYSBmdW5jdGlvbiB0aGF0IGFjY2VwdHMgdGhlIHRhcmdldCBicmFuY2ggc3BlY2lmaWVkIGluIHRoZVxuICAgKiBHaXRodWIgV2ViIFVJLiBUaGlzIGlzIHVzZWZ1bCBmb3Igc3VwcG9ydGluZyBsYWJlbHMgbGlrZSBgdGFyZ2V0OiBkZXZlbG9wbWVudC1icmFuY2hgLlxuICAgKi9cbiAgYnJhbmNoZXM6IHN0cmluZ1tdfCgoZ2l0aHViVGFyZ2V0QnJhbmNoOiBzdHJpbmcpID0+IHN0cmluZ1tdKTtcbn1cblxuLyoqXG4gKiBDb25maWd1cmF0aW9uIGZvciB0aGUgbWVyZ2Ugc2NyaXB0IHdpdGggYWxsIHJlbW90ZSBvcHRpb25zIHNwZWNpZmllZC4gVGhlXG4gKiBkZWZhdWx0IGBNZXJnZUNvbmZpZ2AgaGFzIGRvZXMgbm90IHJlcXVpcmUgYW55IG9mIHRoZXNlIG9wdGlvbnMgYXMgZGVmYXVsdHNcbiAqIGFyZSBwcm92aWRlZCBieSB0aGUgY29tbW9uIGRldi1pbmZyYSBnaXRodWIgY29uZmlndXJhdGlvbi5cbiAqL1xuZXhwb3J0IHR5cGUgTWVyZ2VDb25maWdXaXRoUmVtb3RlID0gTWVyZ2VDb25maWcme3JlbW90ZTogR2l0Q2xpZW50Q29uZmlnfTtcblxuLyoqIENvbmZpZ3VyYXRpb24gZm9yIHRoZSBtZXJnZSBzY3JpcHQuICovXG5leHBvcnQgaW50ZXJmYWNlIE1lcmdlQ29uZmlnIHtcbiAgLyoqXG4gICAqIENvbmZpZ3VyYXRpb24gZm9yIHRoZSB1cHN0cmVhbSByZW1vdGUuIEFsbCBvZiB0aGVzZSBvcHRpb25zIGFyZSBvcHRpb25hbCBhc1xuICAgKiBkZWZhdWx0cyBhcmUgcHJvdmlkZWQgYnkgdGhlIGNvbW1vbiBkZXYtaW5mcmEgZ2l0aHViIGNvbmZpZ3VyYXRpb24uXG4gICAqL1xuICByZW1vdGU/OiBHaXRDbGllbnRDb25maWc7XG4gIC8qKiBMaXN0IG9mIHRhcmdldCBsYWJlbHMuICovXG4gIGxhYmVsczogVGFyZ2V0TGFiZWxbXTtcbiAgLyoqIFJlcXVpcmVkIGJhc2UgY29tbWl0cyBmb3IgZ2l2ZW4gYnJhbmNoZXMuICovXG4gIHJlcXVpcmVkQmFzZUNvbW1pdHM/OiB7W2JyYW5jaE5hbWU6IHN0cmluZ106IHN0cmluZ307XG4gIC8qKiBQYXR0ZXJuIHRoYXQgbWF0Y2hlcyBsYWJlbHMgd2hpY2ggaW1wbHkgYSBzaWduZWQgQ0xBLiAqL1xuICBjbGFTaWduZWRMYWJlbDogc3RyaW5nfFJlZ0V4cDtcbiAgLyoqIFBhdHRlcm4gdGhhdCBtYXRjaGVzIGxhYmVscyB3aGljaCBpbXBseSBhIG1lcmdlIHJlYWR5IHB1bGwgcmVxdWVzdC4gKi9cbiAgbWVyZ2VSZWFkeUxhYmVsOiBzdHJpbmd8UmVnRXhwO1xuICAvKiogTGFiZWwgdGhhdCBpcyBhcHBsaWVkIHdoZW4gc3BlY2lhbCBhdHRlbnRpb24gZnJvbSB0aGUgY2FyZXRha2VyIGlzIHJlcXVpcmVkLiAqL1xuICBjYXJldGFrZXJOb3RlTGFiZWw/OiBzdHJpbmd8UmVnRXhwO1xuICAvKiogTGFiZWwgd2hpY2ggY2FuIGJlIGFwcGxpZWQgdG8gZml4dXAgY29tbWl0IG1lc3NhZ2VzIGluIHRoZSBtZXJnZSBzY3JpcHQuICovXG4gIGNvbW1pdE1lc3NhZ2VGaXh1cExhYmVsOiBzdHJpbmd8UmVnRXhwO1xuICAvKipcbiAgICogV2hldGhlciBwdWxsIHJlcXVlc3RzIHNob3VsZCBiZSBtZXJnZWQgdXNpbmcgdGhlIEdpdGh1YiBBUEkuIFRoaXMgY2FuIGJlIGVuYWJsZWRcbiAgICogaWYgcHJvamVjdHMgd2FudCB0byBoYXZlIHRoZWlyIHB1bGwgcmVxdWVzdHMgc2hvdyB1cCBhcyBgTWVyZ2VkYCBpbiB0aGUgR2l0aHViIFVJLlxuICAgKiBUaGUgZG93bnNpZGUgaXMgdGhhdCBmaXh1cCBvciBzcXVhc2ggY29tbWl0cyBubyBsb25nZXIgd29yayBhcyB0aGUgR2l0aHViIEFQSSBkb2VzXG4gICAqIG5vdCBzdXBwb3J0IHRoaXMuXG4gICAqL1xuICBnaXRodWJBcGlNZXJnZTogZmFsc2V8R2l0aHViQXBpTWVyZ2VTdHJhdGVneUNvbmZpZztcbn1cblxuLyoqXG4gKiBDb25maWd1cmF0aW9uIG9mIHRoZSBtZXJnZSBzY3JpcHQgaW4gdGhlIGRldi1pbmZyYSBjb25maWd1cmF0aW9uLiBOb3RlIHRoYXQgdGhlXG4gKiBtZXJnZSBjb25maWd1cmF0aW9uIGlzIHJldHJpZXZlZCBsYXppbHkgYXMgdXN1YWxseSB0aGVzZSBjb25maWd1cmF0aW9ucyByZWx5XG4gKiBvbiBicmFuY2ggbmFtZSBjb21wdXRhdGlvbnMuIFdlIGRvbid0IHdhbnQgdG8gcnVuIHRoZXNlIGltbWVkaWF0ZWx5IHdoZW5ldmVyXG4gKiB0aGUgZGV2LWluZnJhIGNvbmZpZ3VyYXRpb24gaXMgbG9hZGVkIGFzIHRoYXQgY291bGQgc2xvdy1kb3duIG90aGVyIGNvbW1hbmRzLlxuICovXG5leHBvcnQgdHlwZSBEZXZJbmZyYU1lcmdlQ29uZmlnID0gTmdEZXZDb25maWc8eydtZXJnZSc6ICgpID0+IE1lcmdlQ29uZmlnfT47XG5cbi8qKiBMb2FkcyBhbmQgdmFsaWRhdGVzIHRoZSBtZXJnZSBjb25maWd1cmF0aW9uLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvYWRBbmRWYWxpZGF0ZUNvbmZpZygpOiB7Y29uZmlnPzogTWVyZ2VDb25maWdXaXRoUmVtb3RlLCBlcnJvcnM/OiBzdHJpbmdbXX0ge1xuICBjb25zdCBjb25maWc6IFBhcnRpYWw8RGV2SW5mcmFNZXJnZUNvbmZpZz4gPSBnZXRDb25maWcoKTtcblxuICBpZiAoY29uZmlnLm1lcmdlID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4ge2Vycm9yczogWydObyBtZXJnZSBjb25maWd1cmF0aW9uIGZvdW5kLiBTZXQgdGhlIGBtZXJnZWAgY29uZmlndXJhdGlvbi4nXX07XG4gIH1cblxuICBpZiAodHlwZW9mIGNvbmZpZy5tZXJnZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiB7ZXJyb3JzOiBbJ0V4cGVjdGVkIG1lcmdlIGNvbmZpZ3VyYXRpb24gdG8gYmUgZGVmaW5lZCBsYXppbHkgdGhyb3VnaCBhIGZ1bmN0aW9uLiddfTtcbiAgfVxuXG4gIGNvbnN0IG1lcmdlQ29uZmlnID0gY29uZmlnLm1lcmdlKCk7XG4gIGNvbnN0IGVycm9ycyA9IHZhbGlkYXRlTWVyZ2VDb25maWcobWVyZ2VDb25maWcpO1xuXG4gIGlmIChlcnJvcnMubGVuZ3RoKSB7XG4gICAgcmV0dXJuIHtlcnJvcnN9O1xuICB9XG5cbiAgaWYgKG1lcmdlQ29uZmlnLnJlbW90ZSkge1xuICAgIG1lcmdlQ29uZmlnLnJlbW90ZSA9IHsuLi5jb25maWcuZ2l0aHViLCAuLi5tZXJnZUNvbmZpZy5yZW1vdGV9O1xuICB9IGVsc2Uge1xuICAgIG1lcmdlQ29uZmlnLnJlbW90ZSA9IGNvbmZpZy5naXRodWI7XG4gIH1cblxuICAvLyBXZSBhbHdheXMgc2V0IHRoZSBgcmVtb3RlYCBvcHRpb24sIHNvIHdlIGNhbiBzYWZlbHkgY2FzdCB0aGVcbiAgLy8gY29uZmlnIHRvIGBNZXJnZUNvbmZpZ1dpdGhSZW1vdGVgLlxuICByZXR1cm4ge2NvbmZpZzogbWVyZ2VDb25maWcgYXMgTWVyZ2VDb25maWdXaXRoUmVtb3RlfTtcbn1cblxuLyoqIFZhbGlkYXRlcyB0aGUgc3BlY2lmaWVkIGNvbmZpZ3VyYXRpb24uIFJldHVybnMgYSBsaXN0IG9mIGZhaWx1cmUgbWVzc2FnZXMuICovXG5mdW5jdGlvbiB2YWxpZGF0ZU1lcmdlQ29uZmlnKGNvbmZpZzogUGFydGlhbDxNZXJnZUNvbmZpZz4pOiBzdHJpbmdbXSB7XG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcbiAgaWYgKCFjb25maWcubGFiZWxzKSB7XG4gICAgZXJyb3JzLnB1c2goJ05vIGxhYmVsIGNvbmZpZ3VyYXRpb24uJyk7XG4gIH0gZWxzZSBpZiAoIUFycmF5LmlzQXJyYXkoY29uZmlnLmxhYmVscykpIHtcbiAgICBlcnJvcnMucHVzaCgnTGFiZWwgY29uZmlndXJhdGlvbiBuZWVkcyB0byBiZSBhbiBhcnJheS4nKTtcbiAgfVxuICBpZiAoIWNvbmZpZy5jbGFTaWduZWRMYWJlbCkge1xuICAgIGVycm9ycy5wdXNoKCdObyBDTEEgc2lnbmVkIGxhYmVsIGNvbmZpZ3VyZWQuJyk7XG4gIH1cbiAgaWYgKCFjb25maWcubWVyZ2VSZWFkeUxhYmVsKSB7XG4gICAgZXJyb3JzLnB1c2goJ05vIG1lcmdlIHJlYWR5IGxhYmVsIGNvbmZpZ3VyZWQuJyk7XG4gIH1cbiAgaWYgKGNvbmZpZy5naXRodWJBcGlNZXJnZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgZXJyb3JzLnB1c2goJ05vIGV4cGxpY2l0IGNob2ljZSBvZiBtZXJnZSBzdHJhdGVneS4gUGxlYXNlIHNldCBgZ2l0aHViQXBpTWVyZ2VgLicpO1xuICB9XG4gIHJldHVybiBlcnJvcnM7XG59XG4iXX0=
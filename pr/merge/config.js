/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
(function (factory) {
    if (typeof module === "object" && typeof module.exports === "object") {
        var v = factory(require, exports);
        if (v !== undefined) module.exports = v;
    }
    else if (typeof define === "function" && define.amd) {
        define("@angular/dev-infra-private/pr/merge/config", ["require", "exports", "tslib", "@angular/dev-infra-private/utils/config"], factory);
    }
})(function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.loadAndValidateConfig = void 0;
    var tslib_1 = require("tslib");
    var config_1 = require("@angular/dev-infra-private/utils/config");
    /** Loads and validates the merge configuration. */
    function loadAndValidateConfig() {
        var config = config_1.getConfig();
        if (config.merge === undefined) {
            return { errors: ['No merge configuration found. Set the `merge` configuration.'] };
        }
        if (typeof config.merge !== 'function') {
            return { errors: ['Expected merge configuration to be defined lazily through a function.'] };
        }
        var mergeConfig = config.merge();
        var errors = validateMergeConfig(mergeConfig);
        if (errors.length) {
            return { errors: errors };
        }
        if (mergeConfig.remote) {
            mergeConfig.remote = tslib_1.__assign(tslib_1.__assign({}, config.github), mergeConfig.remote);
        }
        else {
            mergeConfig.remote = config.github;
        }
        // We always set the `remote` option, so we can safely cast the
        // config to `MergeConfigWithRemote`.
        return { config: mergeConfig };
    }
    exports.loadAndValidateConfig = loadAndValidateConfig;
    /** Validates the specified configuration. Returns a list of failure messages. */
    function validateMergeConfig(config) {
        var errors = [];
        if (!config.labels) {
            errors.push('No label configuration.');
        }
        else if (!Array.isArray(config.labels)) {
            errors.push('Label configuration needs to be an array.');
        }
        if (!config.claSignedLabel) {
            errors.push('No CLA signed label configured.');
        }
        if (!config.mergeReadyLabel) {
            errors.push('No merge ready label configured.');
        }
        if (config.githubApiMerge === undefined) {
            errors.push('No explicit choice of merge strategy. Please set `githubApiMerge`.');
        }
        return errors;
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlnLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vZGV2LWluZnJhL3ByL21lcmdlL2NvbmZpZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7O0dBTUc7Ozs7Ozs7Ozs7Ozs7O0lBRUgsa0VBQTBEO0lBNEUxRCxtREFBbUQ7SUFDbkQsU0FBZ0IscUJBQXFCO1FBQ25DLElBQU0sTUFBTSxHQUFpQyxrQkFBUyxFQUFFLENBQUM7UUFFekQsSUFBSSxNQUFNLENBQUMsS0FBSyxLQUFLLFNBQVMsRUFBRTtZQUM5QixPQUFPLEVBQUMsTUFBTSxFQUFFLENBQUMsOERBQThELENBQUMsRUFBQyxDQUFDO1NBQ25GO1FBRUQsSUFBSSxPQUFPLE1BQU0sQ0FBQyxLQUFLLEtBQUssVUFBVSxFQUFFO1lBQ3RDLE9BQU8sRUFBQyxNQUFNLEVBQUUsQ0FBQyx1RUFBdUUsQ0FBQyxFQUFDLENBQUM7U0FDNUY7UUFFRCxJQUFNLFdBQVcsR0FBRyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDbkMsSUFBTSxNQUFNLEdBQUcsbUJBQW1CLENBQUMsV0FBVyxDQUFDLENBQUM7UUFFaEQsSUFBSSxNQUFNLENBQUMsTUFBTSxFQUFFO1lBQ2pCLE9BQU8sRUFBQyxNQUFNLFFBQUEsRUFBQyxDQUFDO1NBQ2pCO1FBRUQsSUFBSSxXQUFXLENBQUMsTUFBTSxFQUFFO1lBQ3RCLFdBQVcsQ0FBQyxNQUFNLHlDQUFPLE1BQU0sQ0FBQyxNQUFNLEdBQUssV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1NBQ2hFO2FBQU07WUFDTCxXQUFXLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUM7U0FDcEM7UUFFRCwrREFBK0Q7UUFDL0QscUNBQXFDO1FBQ3JDLE9BQU8sRUFBQyxNQUFNLEVBQUUsV0FBb0MsRUFBQyxDQUFDO0lBQ3hELENBQUM7SUEzQkQsc0RBMkJDO0lBRUQsaUZBQWlGO0lBQ2pGLFNBQVMsbUJBQW1CLENBQUMsTUFBNEI7UUFDdkQsSUFBTSxNQUFNLEdBQWEsRUFBRSxDQUFDO1FBQzVCLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFO1lBQ2xCLE1BQU0sQ0FBQyxJQUFJLENBQUMseUJBQXlCLENBQUMsQ0FBQztTQUN4QzthQUFNLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUN4QyxNQUFNLENBQUMsSUFBSSxDQUFDLDJDQUEyQyxDQUFDLENBQUM7U0FDMUQ7UUFDRCxJQUFJLENBQUMsTUFBTSxDQUFDLGNBQWMsRUFBRTtZQUMxQixNQUFNLENBQUMsSUFBSSxDQUFDLGlDQUFpQyxDQUFDLENBQUM7U0FDaEQ7UUFDRCxJQUFJLENBQUMsTUFBTSxDQUFDLGVBQWUsRUFBRTtZQUMzQixNQUFNLENBQUMsSUFBSSxDQUFDLGtDQUFrQyxDQUFDLENBQUM7U0FDakQ7UUFDRCxJQUFJLE1BQU0sQ0FBQyxjQUFjLEtBQUssU0FBUyxFQUFFO1lBQ3ZDLE1BQU0sQ0FBQyxJQUFJLENBQUMsb0VBQW9FLENBQUMsQ0FBQztTQUNuRjtRQUNELE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgR29vZ2xlIExMQyBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGFuIE1JVC1zdHlsZSBsaWNlbnNlIHRoYXQgY2FuIGJlXG4gKiBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGF0IGh0dHBzOi8vYW5ndWxhci5pby9saWNlbnNlXG4gKi9cblxuaW1wb3J0IHtnZXRDb25maWcsIE5nRGV2Q29uZmlnfSBmcm9tICcuLi8uLi91dGlscy9jb25maWcnO1xuXG5pbXBvcnQge0dpdGh1YkFwaU1lcmdlU3RyYXRlZ3lDb25maWd9IGZyb20gJy4vc3RyYXRlZ2llcy9hcGktbWVyZ2UnO1xuXG4vKipcbiAqIFBvc3NpYmxlIG1lcmdlIG1ldGhvZHMgc3VwcG9ydGVkIGJ5IHRoZSBHaXRodWIgQVBJLlxuICogaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0aHViLmNvbS92My9wdWxscy8jbWVyZ2UtYS1wdWxsLXJlcXVlc3QtbWVyZ2UtYnV0dG9uLlxuICovXG5leHBvcnQgdHlwZSBHaXRodWJBcGlNZXJnZU1ldGhvZCA9ICdtZXJnZSd8J3NxdWFzaCd8J3JlYmFzZSc7XG5cbi8qKlxuICogVGFyZ2V0IGxhYmVscyByZXByZXNlbnQgR2l0aHViIHB1bGwgcmVxdWVzdHMgbGFiZWxzLiBUaGVzZSBsYWJlbHMgaW5zdHJ1Y3QgdGhlIG1lcmdlXG4gKiBzY3JpcHQgaW50byB3aGljaCBicmFuY2hlcyBhIGdpdmVuIHB1bGwgcmVxdWVzdCBzaG91bGQgYmUgbWVyZ2VkIHRvLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFRhcmdldExhYmVsIHtcbiAgLyoqIFBhdHRlcm4gdGhhdCBtYXRjaGVzIHRoZSBnaXZlbiB0YXJnZXQgbGFiZWwuICovXG4gIHBhdHRlcm46IFJlZ0V4cHxzdHJpbmc7XG4gIC8qKlxuICAgKiBMaXN0IG9mIGJyYW5jaGVzIGEgcHVsbCByZXF1ZXN0IHdpdGggdGhpcyB0YXJnZXQgbGFiZWwgc2hvdWxkIGJlIG1lcmdlZCBpbnRvLlxuICAgKiBDYW4gYWxzbyBiZSB3cmFwcGVkIGluIGEgZnVuY3Rpb24gdGhhdCBhY2NlcHRzIHRoZSB0YXJnZXQgYnJhbmNoIHNwZWNpZmllZCBpbiB0aGVcbiAgICogR2l0aHViIFdlYiBVSS4gVGhpcyBpcyB1c2VmdWwgZm9yIHN1cHBvcnRpbmcgbGFiZWxzIGxpa2UgYHRhcmdldDogZGV2ZWxvcG1lbnQtYnJhbmNoYC5cbiAgICovXG4gIGJyYW5jaGVzOiBzdHJpbmdbXXwoKGdpdGh1YlRhcmdldEJyYW5jaDogc3RyaW5nKSA9PiBzdHJpbmdbXSk7XG59XG5cbi8qKiBEZXNjcmliZXMgdGhlIHJlbW90ZSB1c2VkIGZvciBtZXJnaW5nIHB1bGwgcmVxdWVzdHMuICovXG5leHBvcnQgaW50ZXJmYWNlIE1lcmdlUmVtb3RlIHtcbiAgLyoqIE93bmVyIG5hbWUgb2YgdGhlIHJlcG9zaXRvcnkuICovXG4gIG93bmVyOiBzdHJpbmc7XG4gIC8qKiBOYW1lIG9mIHRoZSByZXBvc2l0b3J5LiAqL1xuICBuYW1lOiBzdHJpbmc7XG4gIC8qKiBXaGV0aGVyIFNTSCBzaG91bGQgYmUgdXNlZCBmb3IgbWVyZ2luZyBwdWxsIHJlcXVlc3RzLiAqL1xuICB1c2VTc2g/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIENvbmZpZ3VyYXRpb24gZm9yIHRoZSBtZXJnZSBzY3JpcHQgd2l0aCBhbGwgcmVtb3RlIG9wdGlvbnMgc3BlY2lmaWVkLiBUaGVcbiAqIGRlZmF1bHQgYE1lcmdlQ29uZmlnYCBoYXMgZG9lcyBub3QgcmVxdWlyZSBhbnkgb2YgdGhlc2Ugb3B0aW9ucyBhcyBkZWZhdWx0c1xuICogYXJlIHByb3ZpZGVkIGJ5IHRoZSBjb21tb24gZGV2LWluZnJhIGdpdGh1YiBjb25maWd1cmF0aW9uLlxuICovXG5leHBvcnQgdHlwZSBNZXJnZUNvbmZpZ1dpdGhSZW1vdGUgPSBNZXJnZUNvbmZpZyZ7cmVtb3RlOiBNZXJnZVJlbW90ZX07XG5cbi8qKiBDb25maWd1cmF0aW9uIGZvciB0aGUgbWVyZ2Ugc2NyaXB0LiAqL1xuZXhwb3J0IGludGVyZmFjZSBNZXJnZUNvbmZpZyB7XG4gIC8qKlxuICAgKiBDb25maWd1cmF0aW9uIGZvciB0aGUgdXBzdHJlYW0gcmVtb3RlLiBBbGwgb2YgdGhlc2Ugb3B0aW9ucyBhcmUgb3B0aW9uYWwgYXNcbiAgICogZGVmYXVsdHMgYXJlIHByb3ZpZGVkIGJ5IHRoZSBjb21tb24gZGV2LWluZnJhIGdpdGh1YiBjb25maWd1cmF0aW9uLlxuICAgKi9cbiAgcmVtb3RlPzogUGFydGlhbDxNZXJnZVJlbW90ZT47XG4gIC8qKiBMaXN0IG9mIHRhcmdldCBsYWJlbHMuICovXG4gIGxhYmVsczogVGFyZ2V0TGFiZWxbXTtcbiAgLyoqIFJlcXVpcmVkIGJhc2UgY29tbWl0cyBmb3IgZ2l2ZW4gYnJhbmNoZXMuICovXG4gIHJlcXVpcmVkQmFzZUNvbW1pdHM/OiB7W2JyYW5jaE5hbWU6IHN0cmluZ106IHN0cmluZ307XG4gIC8qKiBQYXR0ZXJuIHRoYXQgbWF0Y2hlcyBsYWJlbHMgd2hpY2ggaW1wbHkgYSBzaWduZWQgQ0xBLiAqL1xuICBjbGFTaWduZWRMYWJlbDogc3RyaW5nfFJlZ0V4cDtcbiAgLyoqIFBhdHRlcm4gdGhhdCBtYXRjaGVzIGxhYmVscyB3aGljaCBpbXBseSBhIG1lcmdlIHJlYWR5IHB1bGwgcmVxdWVzdC4gKi9cbiAgbWVyZ2VSZWFkeUxhYmVsOiBzdHJpbmd8UmVnRXhwO1xuICAvKiogTGFiZWwgd2hpY2ggY2FuIGJlIGFwcGxpZWQgdG8gZml4dXAgY29tbWl0IG1lc3NhZ2VzIGluIHRoZSBtZXJnZSBzY3JpcHQuICovXG4gIGNvbW1pdE1lc3NhZ2VGaXh1cExhYmVsOiBzdHJpbmd8UmVnRXhwO1xuICAvKipcbiAgICogV2hldGhlciBwdWxsIHJlcXVlc3RzIHNob3VsZCBiZSBtZXJnZWQgdXNpbmcgdGhlIEdpdGh1YiBBUEkuIFRoaXMgY2FuIGJlIGVuYWJsZWRcbiAgICogaWYgcHJvamVjdHMgd2FudCB0byBoYXZlIHRoZWlyIHB1bGwgcmVxdWVzdHMgc2hvdyB1cCBhcyBgTWVyZ2VkYCBpbiB0aGUgR2l0aHViIFVJLlxuICAgKiBUaGUgZG93bnNpZGUgaXMgdGhhdCBmaXh1cCBvciBzcXVhc2ggY29tbWl0cyBubyBsb25nZXIgd29yayBhcyB0aGUgR2l0aHViIEFQSSBkb2VzXG4gICAqIG5vdCBzdXBwb3J0IHRoaXMuXG4gICAqL1xuICBnaXRodWJBcGlNZXJnZTogZmFsc2V8R2l0aHViQXBpTWVyZ2VTdHJhdGVneUNvbmZpZztcbn1cblxuLyoqXG4gKiBDb25maWd1cmF0aW9uIG9mIHRoZSBtZXJnZSBzY3JpcHQgaW4gdGhlIGRldi1pbmZyYSBjb25maWd1cmF0aW9uLiBOb3RlIHRoYXQgdGhlXG4gKiBtZXJnZSBjb25maWd1cmF0aW9uIGlzIHJldHJpZXZlZCBsYXppbHkgYXMgdXN1YWxseSB0aGVzZSBjb25maWd1cmF0aW9ucyByZWx5XG4gKiBvbiBicmFuY2ggbmFtZSBjb21wdXRhdGlvbnMuIFdlIGRvbid0IHdhbnQgdG8gcnVuIHRoZXNlIGltbWVkaWF0ZWx5IHdoZW5ldmVyXG4gKiB0aGUgZGV2LWluZnJhIGNvbmZpZ3VyYXRpb24gaXMgbG9hZGVkIGFzIHRoYXQgY291bGQgc2xvdy1kb3duIG90aGVyIGNvbW1hbmRzLlxuICovXG5leHBvcnQgdHlwZSBEZXZJbmZyYU1lcmdlQ29uZmlnID0gTmdEZXZDb25maWc8eydtZXJnZSc6ICgpID0+IE1lcmdlQ29uZmlnfT47XG5cbi8qKiBMb2FkcyBhbmQgdmFsaWRhdGVzIHRoZSBtZXJnZSBjb25maWd1cmF0aW9uLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvYWRBbmRWYWxpZGF0ZUNvbmZpZygpOiB7Y29uZmlnPzogTWVyZ2VDb25maWdXaXRoUmVtb3RlLCBlcnJvcnM/OiBzdHJpbmdbXX0ge1xuICBjb25zdCBjb25maWc6IFBhcnRpYWw8RGV2SW5mcmFNZXJnZUNvbmZpZz4gPSBnZXRDb25maWcoKTtcblxuICBpZiAoY29uZmlnLm1lcmdlID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4ge2Vycm9yczogWydObyBtZXJnZSBjb25maWd1cmF0aW9uIGZvdW5kLiBTZXQgdGhlIGBtZXJnZWAgY29uZmlndXJhdGlvbi4nXX07XG4gIH1cblxuICBpZiAodHlwZW9mIGNvbmZpZy5tZXJnZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiB7ZXJyb3JzOiBbJ0V4cGVjdGVkIG1lcmdlIGNvbmZpZ3VyYXRpb24gdG8gYmUgZGVmaW5lZCBsYXppbHkgdGhyb3VnaCBhIGZ1bmN0aW9uLiddfTtcbiAgfVxuXG4gIGNvbnN0IG1lcmdlQ29uZmlnID0gY29uZmlnLm1lcmdlKCk7XG4gIGNvbnN0IGVycm9ycyA9IHZhbGlkYXRlTWVyZ2VDb25maWcobWVyZ2VDb25maWcpO1xuXG4gIGlmIChlcnJvcnMubGVuZ3RoKSB7XG4gICAgcmV0dXJuIHtlcnJvcnN9O1xuICB9XG5cbiAgaWYgKG1lcmdlQ29uZmlnLnJlbW90ZSkge1xuICAgIG1lcmdlQ29uZmlnLnJlbW90ZSA9IHsuLi5jb25maWcuZ2l0aHViLCAuLi5tZXJnZUNvbmZpZy5yZW1vdGV9O1xuICB9IGVsc2Uge1xuICAgIG1lcmdlQ29uZmlnLnJlbW90ZSA9IGNvbmZpZy5naXRodWI7XG4gIH1cblxuICAvLyBXZSBhbHdheXMgc2V0IHRoZSBgcmVtb3RlYCBvcHRpb24sIHNvIHdlIGNhbiBzYWZlbHkgY2FzdCB0aGVcbiAgLy8gY29uZmlnIHRvIGBNZXJnZUNvbmZpZ1dpdGhSZW1vdGVgLlxuICByZXR1cm4ge2NvbmZpZzogbWVyZ2VDb25maWcgYXMgTWVyZ2VDb25maWdXaXRoUmVtb3RlfTtcbn1cblxuLyoqIFZhbGlkYXRlcyB0aGUgc3BlY2lmaWVkIGNvbmZpZ3VyYXRpb24uIFJldHVybnMgYSBsaXN0IG9mIGZhaWx1cmUgbWVzc2FnZXMuICovXG5mdW5jdGlvbiB2YWxpZGF0ZU1lcmdlQ29uZmlnKGNvbmZpZzogUGFydGlhbDxNZXJnZUNvbmZpZz4pOiBzdHJpbmdbXSB7XG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcbiAgaWYgKCFjb25maWcubGFiZWxzKSB7XG4gICAgZXJyb3JzLnB1c2goJ05vIGxhYmVsIGNvbmZpZ3VyYXRpb24uJyk7XG4gIH0gZWxzZSBpZiAoIUFycmF5LmlzQXJyYXkoY29uZmlnLmxhYmVscykpIHtcbiAgICBlcnJvcnMucHVzaCgnTGFiZWwgY29uZmlndXJhdGlvbiBuZWVkcyB0byBiZSBhbiBhcnJheS4nKTtcbiAgfVxuICBpZiAoIWNvbmZpZy5jbGFTaWduZWRMYWJlbCkge1xuICAgIGVycm9ycy5wdXNoKCdObyBDTEEgc2lnbmVkIGxhYmVsIGNvbmZpZ3VyZWQuJyk7XG4gIH1cbiAgaWYgKCFjb25maWcubWVyZ2VSZWFkeUxhYmVsKSB7XG4gICAgZXJyb3JzLnB1c2goJ05vIG1lcmdlIHJlYWR5IGxhYmVsIGNvbmZpZ3VyZWQuJyk7XG4gIH1cbiAgaWYgKGNvbmZpZy5naXRodWJBcGlNZXJnZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgZXJyb3JzLnB1c2goJ05vIGV4cGxpY2l0IGNob2ljZSBvZiBtZXJnZSBzdHJhdGVneS4gUGxlYXNlIHNldCBgZ2l0aHViQXBpTWVyZ2VgLicpO1xuICB9XG4gIHJldHVybiBlcnJvcnM7XG59XG4iXX0=
"use strict";
/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
Object.defineProperty(exports, "__esModule", { value: true });
/*
 * This file will be spawned as a separate process when the `ng-dev release build` command is
 * invoked. A separate process allows us to hide any superfluous stdout output from arbitrary
 * build commands that we cannot control. This is necessary as the `ng-dev release build` command
 * supports stdout JSON output that should be parsable and not polluted from other stdout messages.
 */
const config_1 = require("../../utils/config");
const index_1 = require("../config/index");
// Start the release package building.
main().catch((e) => {
    console.error(e);
    throw e;
});
/** Main function for building the release packages. */
async function main() {
    if (process.send === undefined) {
        throw Error('This script needs to be invoked as a NodeJS worker.');
    }
    const config = (0, config_1.getConfig)();
    (0, index_1.assertValidReleaseConfig)(config);
    const builtPackages = await config.release.buildPackages();
    // Transfer the built packages back to the parent process.
    process.send(builtPackages);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVpbGQtd29ya2VyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vbmctZGV2L3JlbGVhc2UvYnVpbGQvYnVpbGQtd29ya2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7O0dBTUc7O0FBRUg7Ozs7O0dBS0c7QUFFSCwrQ0FBNkM7QUFDN0MsMkNBQXlEO0FBRXpELHNDQUFzQztBQUN0QyxJQUFJLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRTtJQUNqQixPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2pCLE1BQU0sQ0FBQyxDQUFDO0FBQ1YsQ0FBQyxDQUFDLENBQUM7QUFFSCx1REFBdUQ7QUFDdkQsS0FBSyxVQUFVLElBQUk7SUFDakIsSUFBSSxPQUFPLENBQUMsSUFBSSxLQUFLLFNBQVMsRUFBRTtRQUM5QixNQUFNLEtBQUssQ0FBQyxxREFBcUQsQ0FBQyxDQUFDO0tBQ3BFO0lBRUQsTUFBTSxNQUFNLEdBQUcsSUFBQSxrQkFBUyxHQUFFLENBQUM7SUFDM0IsSUFBQSxnQ0FBd0IsRUFBQyxNQUFNLENBQUMsQ0FBQztJQUVqQyxNQUFNLGFBQWEsR0FBRyxNQUFNLE1BQU0sQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUFFLENBQUM7SUFFM0QsMERBQTBEO0lBQzFELE9BQU8sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7QUFDOUIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCBHb29nbGUgTExDIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYW4gTUlULXN0eWxlIGxpY2Vuc2UgdGhhdCBjYW4gYmVcbiAqIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgYXQgaHR0cHM6Ly9hbmd1bGFyLmlvL2xpY2Vuc2VcbiAqL1xuXG4vKlxuICogVGhpcyBmaWxlIHdpbGwgYmUgc3Bhd25lZCBhcyBhIHNlcGFyYXRlIHByb2Nlc3Mgd2hlbiB0aGUgYG5nLWRldiByZWxlYXNlIGJ1aWxkYCBjb21tYW5kIGlzXG4gKiBpbnZva2VkLiBBIHNlcGFyYXRlIHByb2Nlc3MgYWxsb3dzIHVzIHRvIGhpZGUgYW55IHN1cGVyZmx1b3VzIHN0ZG91dCBvdXRwdXQgZnJvbSBhcmJpdHJhcnlcbiAqIGJ1aWxkIGNvbW1hbmRzIHRoYXQgd2UgY2Fubm90IGNvbnRyb2wuIFRoaXMgaXMgbmVjZXNzYXJ5IGFzIHRoZSBgbmctZGV2IHJlbGVhc2UgYnVpbGRgIGNvbW1hbmRcbiAqIHN1cHBvcnRzIHN0ZG91dCBKU09OIG91dHB1dCB0aGF0IHNob3VsZCBiZSBwYXJzYWJsZSBhbmQgbm90IHBvbGx1dGVkIGZyb20gb3RoZXIgc3Rkb3V0IG1lc3NhZ2VzLlxuICovXG5cbmltcG9ydCB7Z2V0Q29uZmlnfSBmcm9tICcuLi8uLi91dGlscy9jb25maWcnO1xuaW1wb3J0IHthc3NlcnRWYWxpZFJlbGVhc2VDb25maWd9IGZyb20gJy4uL2NvbmZpZy9pbmRleCc7XG5cbi8vIFN0YXJ0IHRoZSByZWxlYXNlIHBhY2thZ2UgYnVpbGRpbmcuXG5tYWluKCkuY2F0Y2goKGUpID0+IHtcbiAgY29uc29sZS5lcnJvcihlKTtcbiAgdGhyb3cgZTtcbn0pO1xuXG4vKiogTWFpbiBmdW5jdGlvbiBmb3IgYnVpbGRpbmcgdGhlIHJlbGVhc2UgcGFja2FnZXMuICovXG5hc3luYyBmdW5jdGlvbiBtYWluKCkge1xuICBpZiAocHJvY2Vzcy5zZW5kID09PSB1bmRlZmluZWQpIHtcbiAgICB0aHJvdyBFcnJvcignVGhpcyBzY3JpcHQgbmVlZHMgdG8gYmUgaW52b2tlZCBhcyBhIE5vZGVKUyB3b3JrZXIuJyk7XG4gIH1cblxuICBjb25zdCBjb25maWcgPSBnZXRDb25maWcoKTtcbiAgYXNzZXJ0VmFsaWRSZWxlYXNlQ29uZmlnKGNvbmZpZyk7XG5cbiAgY29uc3QgYnVpbHRQYWNrYWdlcyA9IGF3YWl0IGNvbmZpZy5yZWxlYXNlLmJ1aWxkUGFja2FnZXMoKTtcblxuICAvLyBUcmFuc2ZlciB0aGUgYnVpbHQgcGFja2FnZXMgYmFjayB0byB0aGUgcGFyZW50IHByb2Nlc3MuXG4gIHByb2Nlc3Muc2VuZChidWlsdFBhY2thZ2VzKTtcbn1cbiJdfQ==